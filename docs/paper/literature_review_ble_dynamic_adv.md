以下は、BLEアドバタイズ間隔制御と省電力・到達性評価・バンディット学習適用に関する先行研究の整理ノートです。  
ReFormHAR‑Tiny プロジェクトのペーパー用バックグラウンドとして位置づけ、要件定義や設計書からは独立に管理します。

---

# 1. 調査の目的と観点

本調査では、次の 3 点を同時に満たす先行研究が存在するかを確認した。

1. **BLEアドバタイズ間隔を動的に調整して省電力化すること**  
2. **実機で電力と通信到達性（PDR, TL, Pout など）を同時に測定して評価していること**  
3. **マルチアーム・バンディット（MAB）等のオンライン学習で環境適応を行っていること**  

これらを満たす研究が既にあるか、もしくは部分的に満たす研究の組み合わせがどの程度存在するかを確認した。

---

# 2. 動的アドバタイズ間隔制御に関する先行研究

## 2.1 ヒューリスティック／ルールベースな制御

- 無線チャネルの混雑度やビーコン受信状況に応じて、**広告間隔を伸縮させるヒューリスティックな手法**はいくつか報告されている。
  - 例: 周囲のトラフィック密度（近接ビーコン数やスキャン成功率）に応じて、`adv_interval` を段階的に増減させる方式。
  - 例: 電子棚札やデジタルサイネージにおいて、**人気度・アクセス頻度**に応じて広告頻度を下げることで電力を節約する方式。
- 多くの場合、
  - 制御則は「if 混雑度>閾値 then intervalを伸ばす」といった**固定ロジック**であり、
  - オフラインで決めたパラメタに従って挙動するに留まる。

## 2.2 最適化問題としての扱い

- 一部の研究では、「発見遅延」と「消費電力」のトレードオフを解析的にモデル化し、**最適な広告間隔を数値的に求める**手法が提案されている。
  - 例: ビーコン発見までの期待遅延を解析し、許容遅延の範囲内で電力を最小化する `adv_interval` を導出する研究。
- これらは主に
  - 理論解析やシミュレーションに基づき、
  - 実システムへの実装は「固定値（最適値）」として適用する形が多い。
- 一方で、
  - **環境が時間とともに変動すること**を前提にした「オンライン最適化」としての扱いは少なく、
  - 「混雑度に応じてローカルルールで伸縮する」レベルで止まっているものが多い。

## 2.3 調査からの示唆

- 「動的に広告間隔を変える」というアイデア自体は先行研究にも見られるが、
  - その多くは **ヒューリスティック／ルールベース**であり、
  - **オンライン学習で逐次的に最適化する枠組み**までは踏み込んでいない。

---

# 3. 電力・到達性の実機評価に関する先行研究

## 3.1 BLE性能の一般的なレビュー

- BLEのスループット・到達距離・省電力性に関するレビュー論文では、
  - 理論スループット（≈230 kbps）に対して実効スループットは ≈100 kbps 程度、
  - 送信電力に依存しつつも、屋内で数十メートル程度の到達距離、
  - 接続型 vs 非接続型の損得（スキャン負荷など）
  といった整理が行われている。
- しかし、
  - **アドバタイズ間隔を複数条件で振りつつ**、
  - **実機で電力と到達性（PDR, TL, Pout）を同時に詳細測定**した研究は限定的である。

## 3.2 実機を用いた計測事例

- いくつかの論文では、BLEビーコンやウェアラブル機器の**電流波形をオシロスコープや専用電力計で測定**し、
  - 省電力モードの比較、
  - 通信パターン（接続間隔や広告間隔）の比較
  を行っている。
- ただし多くは、
  - 評価対象が「平均電流」や「バッテリ寿命推定」に留まり、
  - **受信側ログ（PDR/TL）と統合した評価**までは行っていない。

## 3.3 本調査から見えたギャップ

- 「アドバタイズ間隔を変えながら、**同時に**電力と通信到達性を実機で測る」という観点は、
  - レビュー論文でも「十分に行われていない」と指摘されている。
- 特に以下の点は、ほとんどカバーされていない。
  - **固定でない adv_interval（動的制御）**
  - **ΔE/adv のようなイベント単位のエネルギー指標**
  - **PDR/TL/Pout を同じ実験系で併記した評価**

---

# 4. バンディット学習・機械学習の適用状況

## 4.1 バンディット学習を用いたBLE制御

- 近年（2024年頃）の研究において、BLEの
  - **広告チャネル数**、
  - **広告間隔の粗い離散集合**
  をアームとみなし、**マルチアーム・バンディット（MAB）** で省電力化を図る例がある。
  - 例: チャネル数や広告頻度を調整し、最大約40%の省電力効果を報告した研究。
- ただし多くの場合、
  - 状態空間は比較的粗く、
  - 目的関数も「平均エネルギー」や「成功率」のような単一指標に近い。
- また、
  - 学習の一部または大半が **シミュレーション環境** で実施され、
  - 実機での**逐次学習（online learning）**は限定的であることが多い。

## 4.2 その他の機械学習的アプローチ

- BLEビーコン配置やチャンネル割り当てに対して、教師あり学習や強化学習を用いる研究も存在する。
  - 例: 人の流れ・滞在時間を予測し、それに合わせてビーコン出力を調整するモデル。
  - 例: シミュレーション上で強化学習によりデューティ比を最適化する研究。
- しかし、
  - 多くは**離線のログ**を使ったモデル学習や、
  - シミュレーション上での評価に留まっており、
  - 実機で広告間隔をオンライン最適化しながら電力と到達性を観測する事例はほぼ見当たらない。

---

# 5. 総合的な位置づけと新規性

## 5.1 調査のまとめ

- 先行研究には、以下のような部分的な要素は存在する。
  - BLE広告間隔をヒューリスティックに動的制御する手法。
  - 電力あるいは到達性のどちらかを中心にした実機評価。
  - BLE関連設定（チャネル数や間隔）に対する MAB や機械学習の適用。
- しかし、本プロジェクトが掲げる次の 3 点を **同時に**満たす研究は確認できなかった。

1. **広告間隔を動的に調整することによる省電力効果の検証**  
2. **実機で「電力＋通信到達性（PDR/TL/Pout）」を同時に計測する評価系**  
3. **マルチアーム・バンディット等によるオンライン環境適応（実環境での逐次学習）**  

## 5.2 本プロジェクトの位置づけ

- ReFormHAR‑Tiny / Phase‑0/1 の計画（擬似U/S → CCS → adv_interval制御、ΔE/adv＋PDR/TL/Pout評価、Phase‑2/3でのMAB/Safe‑MAB化）は、
  - 既存研究に散在する「動的間隔」「実測電力」「到達性」「バンディット学習」の要素を **1つの実験系に統合** するものと位置づけられる。
- 特に以下の点は、先行研究と比較して特徴的である。
  - **ΔE/adv（イベントあたりのエネルギー増分）**を軸とした電力評価。
  - **PDR/TL/Pout** を同時に取る実機実験系（TX/TXSD/RXの三ノード構成）。
  - 将来フェーズでの **Safe‑MAB によるオンライン制御** を見据えた設計。

## 5.3 要件・設計への示唆（メモ）

- 要件定義・設計定義に反映する場合の候補（反映はオーナー承認後）：
  - フェーズ1のKPI項目における **ΔE/adv の位置づけ**（すでにフェーズ0-0で採用済みの考え方を、Phase‑1/2にも明示するかどうか）。
  - 「既存研究との違い」を整理した **非機能要件（再現性・外的妥当性・学習安定性）** の補足。
  - MAB/Safe‑MABフェーズに向けた「オンライン学習実験」の要件定義（評価指標や安全側フォールバック条件など）。

（現時点では要件定義・設計書への直接の修正は行わず、本ファイルはペーパー準備用のリサーチノートとして扱う。）

