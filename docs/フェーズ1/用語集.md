# フェーズ1 用語集（Glossary）

本プロジェクトの設計・要件に即した用語の簡潔な定義。日本語優先・初出で英語（英語略）を併記。

## 推論・スコア関連
- HAR（人的活動認識, Human Activity Recognition）: IMUからオンデバイスで活動を分類する処理。
- IMU（慣性計測ユニット, Inertial Measurement Unit）: 加速度・ジャイロを含む6軸センサ。
- 窓長（Window length）: 1.0 s、50%重畳。出力は0.5 s周期。
- U（不確実度, Uncertainty）: 出力確率の正規化エントロピー。0（確信）〜1（不確実）。
- confidence（確信度, Confidence）: 1 − U。CCSの主成分として用いる。
- S（安定度, Stability）: 直近W=10 sの状態遷移回数から算出した安定度（大きいほど安定）。
- CCS（複合スコア, Composite score）: 0.7×confidence + 0.3×stability。しきい値{θ_low, θ_high}はP1で再較正（初期値0.40/0.70）。
- ヒステリシス（Hysteresis）: 昇降でしきい値を±0.05ずらす処理（例: up_active=0.70, down_active=0.65）。
- 最小滞在時間（Min dwell）: 区分滞在の最短時間（≥2 s）。
- 切替レート制限（Switch rate limit）: 切替頻度の上限（≤1 Hz）。
- 早期出口（Early-Exit）: 中間出力の信頼度が条件（例: max_softmax≥0.90 かつ温度スケーリング後≥0.85）を満たす場合に推論を短絡する方式（Exit-0）。
- 温度スケーリング（Temperature scaling, T）: 確信度の較正。較正後のTはログに保存。

## BLE・ポリシ関連
- BLEレガシー・アドバタイジング（BLE Legacy Advertising）: 非接続・非指向のアドバタイジング。評価はCh 37/38/39の3チャネル固定。
- adv_interval（アドバタイズ間隔）: アドバタイズイベント周期。既定の段階は{100, 500, 2000} ms（比較には1000 msも用いる）。
- ch_mask（チャネル集合, Channel mask）: `0b111`=37/38/39の3チャネル送出を意味。
- 状態区分（ACTIVE/UNCERTAIN/QUIET）: CCSとヒステリシスで決まる伝送区分。各区分にadv_intervalを割当。
- FALLBACK/SAFE: HAR欠落・異常時などの安全側設定（例: 1000 ms固定）。
- Sync ADV: セッション開始時に送る同期アドバタイズ（seq=0）。LED 500 ms点灯と併用。
- seq / ts_tx: アドバタイズのシーケンスID / 送信時刻（送信側基準）。
- 重複除去（Deduplication）: {seq, ts_tx}をキーに判定窓=3×adv_intervalで同一イベントを定義し、最初の到達を採用。

## KPI・計測関連
- TL（初回到達遅延, Time-to-first-Receive）: アクティビティ変化→最初の受信までの遅延。
- Pout(τ)（期限超過率, Outage）: TLがτ（1/2/3 s）を超える確率（Pr[TL>τ]）。
- PDR（受信成功率, Packet Delivery Rate）: 重複除去後ユニーク受信数の割合。
- イベント電荷（Event charge, μC）: アドバタイズイベント（3チャネル送信）の電流積分値。
- 平均電流（Average current）: セッション平均の電流値（比較に使用）。
- 95% CI（信頼区間）: KPIに併記する信頼区間（環境E1/E2別）。

## 実装・実行環境
- 推論モデル（Inference model）: ネットワーク構造＋学習済み重み。最終成果物は量子化済み`.tflite`（int8）。
- TFLiteモデル（.tflite）: 推論モデルをTFLite形式に変換したファイル。デバイスへはバイナリ同梱やC配列化で組み込む。
- TFLM（TensorFlow Lite for Microcontrollers）: `.tflite`を実行する推論ランタイム（インタプリタ＋演算カーネル＋メモリ管理）。
- Tensor Arena（アリーナ, Arena）: TFLMの静的ワーク領域。運用目安64 KB（上限80 KB）。
- Flash（フラッシュ）: モデル等の格納領域。目安≤200 KB。
- FLOPs: 1推論あたりの演算量（乗算加算回数の目安）。制約≤8 M。
- t_inf（推論時間）: 1窓の推論遅延（ms）。`esp_timer`で1000反復計測。制約≤20 ms。
- ESP32-S3/C3: 対象SoC。S3では`esp-nn`最適化カーネルの使用を推奨。

## モデル設計（model定義.mdで使用）
- DS‑CNN（Depthwise Separable CNN）: Depthwise畳み込み＋Pointwise（1×1）畳み込みで軽量化したCNN。
- DS‑CNN++: DS‑CNNを基にしたマルチスケール分岐＋早期出口（Exit‑0）を備える強化版。
- DWConv / PWConv: Depthwise畳み込み / Pointwise（1×1）畳み込み。
- GAP（Global Average Pooling）: 特徴マップを空間平均してベクトル化する層。
- GRU（Gated Recurrent Unit）: 軽量な再帰型ユニット。例: GRU(16)は16ユニット。
- 早期出口（Early‑Exit, Exit‑0）: 中間層の確信度が条件（例: max_softmax≥0.90、T適用後≥0.85）を満たせば最終層をスキップ。
- max_softmax: 出力確率ベクトルの最大成分。確信度の近似指標。
- QAT（Quantization‑Aware Training）: 学習時から量子化誤差を模擬して精度劣化を抑える手法（ConvはPer‑channel量子化推奨）。
- Params（パラメータ数）: 学習可能重みの総数。モデル容量の目安。
- dilation / stride: 畳み込みの膨張率 / ストライド（サンプリング間引き）。
- マルチスケール分岐（Multi‑scale branch）: 1.0 s窓と0.5 s窓など異なる時間スケールの特徴を並列抽出。
- F1（macro）: クラスごとのF1を平均した指標。クラス不均衡の影響を抑える。

## 実験運用
- E1/E2: 環境区分。E1=干渉弱、E2=干渉強（Wi‑Fi混雑）。
- Runbook: 再現性重視の運用手順（`docs/フェーズ1/Runbook.md`）。
- Latin方格（Latin square）: 条件順序の割付法。順序効果を抑制。
- Doze無効化: 受信端末で省電力最適化を停止し、スキャンの安定性を確保。
- {θ_low, θ_high}: CCSの再較正後しきい値。P1（validation）で確定し、初期値0.40/0.70を置換。
